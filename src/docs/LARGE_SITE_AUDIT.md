# –ê—É–¥–∏—Ç –±–æ–ª—å—à–∏—Ö —Å–∞–π—Ç–æ–≤ (80–ö - 10–ú —Å—Ç—Ä–∞–Ω–∏—Ü)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö —Å–∞–π—Ç–æ–≤

### –ü—Ä–æ–±–ª–µ–º—ã —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:
- ‚è±Ô∏è Edge Functions –∏–º–µ—é—Ç –ª–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (~60 —Å–µ–∫—É–Ω–¥)
- üíæ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü
- üîÑ –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤–µ—Å—å —Å–∞–π—Ç –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—É—Å–∫

### –†–µ—à–µ–Ω–∏–µ: –ë–∞—Ç—á–∏–Ω–≥ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    audit-start                          ‚îÇ
‚îÇ              (—Å–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞—á—É –≤ –ë–î)                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ
                        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              audit-processor (–±–∞—Ç—á 1)                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ –ë–î                     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ 2. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å 500 —Å—Ç—Ä–∞–Ω–∏—Ü                        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å + –æ—á–µ—Ä–µ–¥—å URL              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ 4. –í–µ—Ä–Ω—É—Ç—å: "completed: false"                   ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ —á–µ—Ä–µ–∑ Cron)
                        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              audit-processor (–±–∞—Ç—á 2)                   ‚îÇ
‚îÇ         –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ
                       ...
                        ‚îÇ
                        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              audit-processor (–ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞—Ç—á)           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ 1. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã                ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑ SEO + Technical              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã                          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ 4. –í–µ—Ä–Ω—É—Ç—å: "completed: true"                    ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```typescript
const BATCH_SIZE = 500;              // –°—Ç—Ä–∞–Ω–∏—Ü –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—É—Å–∫
const MAX_EXECUTION_TIME = 50000;    // 50 —Å–µ–∫ (—Å –∑–∞–ø–∞—Å–æ–º –¥–æ 60)
const CRAWL_DELAY = 50;              // –º—Å –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
const MAX_CONCURRENT_REQUESTS = 10;  // –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```

### –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–∞–π—Ç–æ–≤:

| –†–∞–∑–º–µ—Ä —Å–∞–π—Ç–∞ | –ë–∞—Ç—á–µ–π | –ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è | –°—Ç—Ä–∞—Ç–µ–≥–∏—è |
|-------------|--------|-----------------|-----------|
| 1,000 —Å—Ç—Ä–∞–Ω–∏—Ü | 2 | 2-5 –º–∏–Ω—É—Ç | –û–¥–∏–Ω –∑–∞–ø—É—Å–∫ |
| 10,000 —Å—Ç—Ä–∞–Ω–∏—Ü | 20 | 20-50 –º–∏–Ω—É—Ç | Cron –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω |
| 100,000 —Å—Ç—Ä–∞–Ω–∏—Ü | 200 | 6-10 —á–∞—Å–æ–≤ | Cron –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É |
| 1,000,000 —Å—Ç—Ä–∞–Ω–∏—Ü | 2,000 | 2-4 –¥–Ω—è | Cron + –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è |
| 10,000,000 —Å—Ç—Ä–∞–Ω–∏—Ü | 20,000 | 20-40 –¥–Ω–µ–π | Sampling + –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è (task_state)

```json
{
  "urlsQueue": ["url1", "url2", "url3", ...],
  "visitedUrls": ["visited1", "visited2", ...],
  "pages": [
    {
      "url": "https://example.com",
      "title": "Example",
      "h1": ["Heading"],
      "statusCode": 200
    }
  ]
}
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase Cron

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—á–µ—Ä–µ–¥–µ–π –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Cron Job:

```sql
-- –í Supabase SQL Editor:

-- –í–∫–ª—é—á–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
CREATE EXTENSION IF NOT EXISTS pg_cron;
CREATE EXTENSION IF NOT EXISTS pg_net;

-- –°–æ–∑–¥–∞—Ç—å Cron Job (–∑–∞–ø—É—Å–∫ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
SELECT cron.schedule(
  'process-audit-tasks',
  '* * * * *', -- –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
  $$
  SELECT net.http_post(
    url := 'https://YOUR_PROJECT_ID.supabase.co/functions/v1/audit-processor',
    headers := '{"Content-Type": "application/json", "Authorization": "Bearer YOUR_ANON_KEY"}'::jsonb
  ) as request_id;
  $$
);
```

**–í–∞–∂–Ω–æ:**
- –ó–∞–º–µ–Ω–∏—Ç–µ `YOUR_PROJECT_ID` –Ω–∞ –≤–∞—à project_id
- –ó–∞–º–µ–Ω–∏—Ç–µ `YOUR_ANON_KEY` –Ω–∞ –≤–∞—à Supabase Anon Key
- –ú–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É: `'*/2 * * * *'` = –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Cron Jobs:

```sql
-- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏
SELECT * FROM cron.job;

-- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
SELECT * FROM cron.job_run_details 
ORDER BY start_time DESC 
LIMIT 10;

-- –£–¥–∞–ª–∏—Ç—å Cron Job (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
SELECT cron.unschedule('process-audit-tasks');
```

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö —Å–∞–π—Ç–æ–≤

### 1. –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü

–î–ª—è —Å–∞–π—Ç–æ–≤ >1M —Å—Ç—Ä–∞–Ω–∏—Ü, —Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å:
- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è
- –¢–æ–ø-100 —Å—Ç—Ä–∞–Ω–∏—Ü –ø–æ —Ç—Ä–∞—Ñ–∏–∫—É (–∏–∑ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏)
- Sitemap.xml (–≥–ª–∞–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã)

```typescript
// –í audit-start –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å priority_urls:
{
  "url": "https://example.com",
  "options": {
    "maxPages": 10000,
    "priorityUrls": [
      "https://example.com/",
      "https://example.com/category1",
      "https://example.com/category2"
    ]
  }
}
```

### 2. Sampling (–≤—ã–±–æ—Ä–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑)

–î–ª—è —Å–∞–π—Ç–æ–≤ >5M —Å—Ç—Ä–∞–Ω–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –≤—ã–±–æ—Ä–∫—É:
- –°–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ 0.1% —Å—Ç—Ä–∞–Ω–∏—Ü
- –≠–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤

### 3. Distributed Processing

–î–ª—è —Å–∞–π—Ç–æ–≤ >10M —Å—Ç—Ä–∞–Ω–∏—Ü —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ:
- –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –ø–æ–¥–¥–æ–º–µ–Ω—ã/—Ä–∞–∑–¥–µ–ª—ã
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–¥–∞—á –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (Screaming Frog, Ahrefs)

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

### Frontend polling:

```typescript
const checkStatus = async (taskId: string) => {
  const { data } = await supabase.functions.invoke('audit-status', {
    body: { task_id: taskId }
  });
  
  console.log(`Progress: ${data.progress}%`);
  console.log(`Pages scanned: ${data.pages_scanned}`);
  console.log(`Queue remaining: ${data.queue_size}`);
  
  if (data.status !== 'completed') {
    // –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å polling
    setTimeout(() => checkStatus(taskId), 5000);
  }
};
```

### Dashboard –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:

```tsx
<div className="audit-progress">
  <Progress value={progress} />
  <p>{pagesScanned} / {estimatedPages} —Å—Ç—Ä–∞–Ω–∏—Ü</p>
  <p>–û—Å—Ç–∞–ª–æ—Å—å URL –≤ –æ—á–µ—Ä–µ–¥–∏: {queueSize}</p>
  <p>–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è: {estimatedTime}</p>
</div>
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### Timeout handling:
- –ö–∞–∂–¥—ã–π batch –∏–º–µ–µ—Ç 50-—Å–µ–∫—É–Ω–¥–Ω—ã–π –ª–∏–º–∏—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç–æ—á–∫–∏

### Network errors:
- Retry –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è failed requests
- Skip –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –ø–æ—Å–ª–µ 3 –ø–æ–ø—ã—Ç–æ–∫
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö URL

### Memory management:
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ pages_data –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- –û—á–∏—Å—Ç–∫–∞ task_state –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- Periodic cleanup —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞—á

```sql
-- –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
DELETE FROM audit_tasks 
WHERE status = 'completed' 
AND completed_at < NOW() - INTERVAL '7 days';
```

## Production Checklist

- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Cron Job –≤ Supabase
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–∑—É–º–Ω—ã–π maxPages (–Ω–µ >100K –±–µ–∑ sampling)
- [ ] –í–∫–ª—é—á–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –¥–æ–ª–≥–∏–µ –∑–∞–¥–∞—á–∏
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –º–∞–ª–æ–º —Å–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞
- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
- [ ] –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CDN/proxy –¥–ª—è crawling
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –ë–î –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤

## –°—Ç–æ–∏–º–æ—Å—Ç—å –∏ —Ä–µ—Å—É—Ä—Å—ã

### Supabase Edge Functions:
- **Free tier**: 500K invocations/month
- **Pro tier**: 2M invocations/month ($25)

–î–ª—è —Å–∞–π—Ç–∞ –≤ 100K —Å—Ç—Ä–∞–Ω–∏—Ü:
- ~200 batches √ó 1 invocation = 200 invocations
- –õ–µ–≥–∫–æ –≤–º–µ—â–∞–µ—Ç—Å—è –≤ Free tier

–î–ª—è —Å–∞–π—Ç–∞ –≤ 10M —Å—Ç—Ä–∞–Ω–∏—Ü:
- ~20,000 batches = 20,000 invocations
- –ü–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è Pro plan –∏–ª–∏ –≤—ã—à–µ

### Database storage:
- –ö–∞–∂–¥–∞—è –∑–∞–¥–∞—á–∞: ~1-10 MB (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç pages_data)
- 100K —Å—Ç—Ä–∞–Ω–∏—Ü: ~500 MB - 1 GB
- –†–µ–≥—É–ª—è—Ä–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞
